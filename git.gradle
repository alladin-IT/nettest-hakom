gradle.allprojects {
    ext.getVersionNameFromGit = {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'describe', '--tags', '--always'
            standardOutput = stdout
        }
        return stdout.toString().trim()
    }

    ext.getBranchFromGit = {
        def stdoutBranch = new ByteArrayOutputStream()
        exec {
        	commandLine 'git', 'symbolic-ref', '--short', 'HEAD'
        	standardOutput = stdoutBranch
        }
        return stdoutBranch.toString().trim()
    }

    ext.getHashFromGit = {
        def stdout = new ByteArrayOutputStream()
        exec {
        	commandLine "git", "log", "--pretty=format:'%h'", "-n 1"
        	standardOutput = stdout
        }
        return stdout.toString().trim()
    }

    ext.getVersionCodeFromGit = {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'rev-list', 'HEAD', '--count'
            standardOutput = stdout
        }
        return stdout.toString().trim().toInteger()
    }
}
